TITLE "Timer 500m_1s";

INCLUDE "lpm_counter.inc";
CONSTANT AVALUE = 3125000;
CONSTANT WIDTH = CEIL(LOG2(AVALUE));

SUBDESIGN clk_500m_1s (
	clk_10k, ena_500m : INPUT;
	clk_125m, clk_500m, clk_1s : OUTPUT;
)
VARIABLE
	cnt_inst : lpm_counter
	WITH (
		LPM_AVALUE = AVALUE,
		LPM_WIDTH = WIDTH,
		LPM_DIRECTION = "UP"
	);
	tffc[4..1] : TFFE;
BEGIN
	cnt_inst.clock = clk_10k;
	tffc[3].ena = ena_500m;
	tffc[] = VCC;
	tffc[1].clk = cnt_inst.cout;
	FOR I IN 2 TO 4 GENERATE
		tffc[i].clk = tffc[i-1];
	END GENERATE;
	
	clk_125m = tffc[1];
	clk_500m = tffc[3];
	clk_1s = tffc[4];
END;